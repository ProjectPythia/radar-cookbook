{"version":2,"kind":"Notebook","sha256":"111dd0c0d68a55ac84e416525b1d4855857e8c3f8605ce50d0290121923fe82d","slug":"notebooks.example-workflows.kdp-comparison","location":"/notebooks/example-workflows/kdp-comparison.ipynb","dependencies":[],"frontmatter":{"title":"Specific Differential Phase (K_{DP}) retrieval methods comparison","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Max Grover","given":"Max","family":"Grover"},"name":"Max Grover","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Zachary Sherman","given":"Zachary","family":"Sherman"},"name":"Zachary Sherman","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Milind Sharma","given":"Milind","family":"Sharma"},"name":"Milind Sharma","id":"contributors-myst-generated-uid-2"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/radar-cookbook","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"abbreviations":{"ARM":"Atmospheric Radiation Measurement"},"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/radar-cookbook/blob/HEAD/notebooks/example-workflows/kdp-comparison.ipynb","thumbnail":"/radar-cookbook/build/kdp_comparison-352b7a202b269766f62eb8c80792fd4f.jpg","exports":[{"format":"ipynb","filename":"kdp-comparison.ipynb","url":"/radar-cookbook/build/kdp-comparison-e61c4c3ebe72851f6656c6eaf5665920.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"image","url":"/radar-cookbook/build/kdp_comparison-352b7a202b269766f62eb8c80792fd4f.jpg","alt":"KDP Comparison","width":700,"key":"qVQUWBm78W","urlSource":"../images/kdp_comparison.jpg"}],"key":"aWHRaU6s8T"}],"key":"vUWKD6YfFf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Specific Differential Phase (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OSYBGTczoX"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"kYnTEYVJyj"},{"type":"text","value":") retrieval methods comparison","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wX16K35ekN"}],"identifier":"specific-differential-phase-k-dp-retrieval-methods-comparison","label":"Specific Differential Phase (K_{DP}) retrieval methods comparison","html_id":"specific-differential-phase-k-dp-retrieval-methods-comparison","implicit":true,"key":"qH16Ru90PG"}],"key":"liZ4sAricD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kb8feNeXbC"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"CY2dFlOFPE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Within this notebook, we will cover:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JIDlm5OFQx"}],"key":"z6pu4cgGS7"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"How to access Colombian national weather radar network data from AWS","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mU7bSt3qcC"}],"key":"r3ow0VEmuI"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"How to read and create a multipanel plot","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NUQ6yiTU3U"}],"key":"LlhcZnFRrk"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"How to retrieve and compare three different methods","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Wlj4lTywhX"}],"key":"zfCIiEqObX"}],"key":"YgEl3Vhn0S"}],"key":"xENz0rUqUA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u9JWkOQNxF"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"S4uFWOr5Uf"},{"type":"table","position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SLW1dlmdIg"}],"key":"HD14ycsNC3"},{"type":"tableCell","header":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kmqBxYyDWw"}],"key":"M5PJ5lbzHS"},{"type":"tableCell","header":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BDS5EkEccT"}],"key":"GZLD4sCqCG"}],"key":"NGR28otBH2"},{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Matplotlib Basics","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"c5xmunlX6G"}],"urlSource":"https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics","key":"Bu1UGtGmah"}],"key":"e4jk8P41mG"},{"type":"tableCell","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Required","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZnX5zeeigo"}],"key":"AxLK0guwt2"},{"type":"tableCell","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Basic plotting","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"SRWr156cvo"}],"key":"z8nTGKimNK"}],"key":"TzU0SwdHXB"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/cartopy/cartopy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Introduction to Cartopy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"izdU5Oi0CC"}],"urlSource":"https://foundations.projectpythia.org/core/cartopy/cartopy","key":"y3n7lGH2eH"}],"key":"uJ2eoBpS7T"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NZJq1KWTXv"}],"key":"wpTs8cmyac"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Adding projections to your plot","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IIKssyeriZ"}],"key":"kuu26fKEEP"}],"key":"mw5mxqX6Og"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"/notebooks/foundations/pyart-basics","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Py-ART Basics","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"teBJwpk3e7"}],"urlSource":"../foundations/pyart-basics","dataUrl":"/notebooks.foundations.pyart-basics.json","internal":true,"protocol":"file","key":"OMZwnksk80"}],"key":"J3rqpK29bh"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Required","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gfHDO4py8u"}],"key":"PvvqYrXfcz"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"IO/Visualization","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RHFDQiJDQN"}],"key":"ktAmOzRgZl"}],"key":"Ywj8wce6Et"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"/notebooks/foundations/pyart-corrections","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Py-ART Corrections","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tGOlhqBS7y"}],"urlSource":"../foundations/pyart-corrections","dataUrl":"/notebooks.foundations.pyart-corrections.json","internal":true,"protocol":"file","key":"N8e8NQjta6"}],"key":"eeZyl11qI7"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Required","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mMkdhvXz9s"}],"key":"fY0fJVX9Iw"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Radar Corrections","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"g3xEVNjaFZ"}],"key":"AIeIEXolZF"}],"key":"uhdfUFUnel"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"../Example-workflows/cacti-data-quality-example","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Py-ART Example-workflows","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RpdQMG2p8C"}],"urlSource":"../Example-workflows/cacti-data-quality-example","key":"hQmcHbM7Kl"}],"key":"lpGQPCBmTT"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Required","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qExtTXz1cR"}],"key":"KLmzCCb0iP"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Dual-polarization variables","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"VheHuqQ64x"}],"key":"dWAuQscnld"}],"key":"MJFqdijmeA"}],"key":"IbkWQgQzYv"},{"type":"thematicBreak","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"F3dYzVlbvg"}],"key":"XxIlQKe9Ry"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KKCqp09iO4"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"kJriCwEXfC"}],"key":"YlDfdLeQ55"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import xradar as xd\nimport pyart\nimport xarray as xr\nimport numpy as np\nimport fsspec\nimport matplotlib.pyplot as plt\nimport cartopy.crs as ccrs\nfrom open_radar_data import DATASETS\nimport matplotlib.ticker as mticker\nimport warnings\n\nwarnings.filterwarnings(\"ignore\")","visibility":"show","key":"FlJnbpPuH7"},{"type":"output","id":"tykHCX77M0WoESeubfkZ5","data":[{"output_type":"stream","name":"stdout","text":"\n## You are using the Python ARM Radar Toolkit (Py-ART), an open source\n## library for working with weather radar data. Py-ART is partly\n## supported by the U.S. Department of Energy as part of the Atmospheric\n## Radiation Measurement (ARM) Climate Research Facility, an Office of\n## Science user facility.\n##\n## If you use this software to prepare a publication, please cite:\n##\n##     JJ Helmus and SM Collis, JORS 2016, doi: 10.5334/jors.119\n\n"}],"visibility":"show","key":"EfSy8lBXi3"}],"visibility":"show","key":"D2l0TVYyFs"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"How to access Colombian national weather radar network data from AWS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RT9t78Ukj6"}],"identifier":"how-to-access-colombian-national-weather-radar-network-data-from-aws","label":"How to access Colombian national weather radar network data from AWS","html_id":"how-to-access-colombian-national-weather-radar-network-data-from-aws","implicit":true,"key":"XptH9Yjmx2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s start first with Level 2 radar data, which is ground-based radar data collected by the Instituto de Hidrología, Meteorología y Estudios Ambientales (IDEAM).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l7IVySZ4D2"}],"key":"NNvoQTcDhn"}],"visibility":"show","key":"fDjhpKn5Z7"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Level 2 Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XQNVgbfIfC"}],"identifier":"level-2-data","label":"Level 2 Data","html_id":"level-2-data","implicit":true,"key":"UHg6bDODH4"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Level 2 data includes all of the fields in a single file - for example, a file may include:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BtZvp4eQeT"}],"key":"IsX0ltUZi8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Reflectivity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HxlZjuxgou"}],"key":"ydou0iuOJf"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Velocity","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rT1m0Yagve"}],"key":"n2YYyJahzL"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Differential reflectivity","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aXI5XRadD2"}],"key":"IQnNccM3NR"}],"key":"XIAJILA8pX"}],"visibility":"show","key":"rExmvVZnfG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Search for data during a Mesoscale Convective System - MCS event (August 9, 2022)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xSAakcVjhl"}],"identifier":"search-for-data-during-a-mesoscale-convective-system-mcs-event-august-9-2022","label":"Search for data during a Mesoscale Convective System - MCS event (August 9, 2022)","html_id":"search-for-data-during-a-mesoscale-convective-system-mcs-event-august-9-2022","implicit":true,"key":"LaBAQxaBEs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will access data from the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nr9uyfIu3F"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"radaresideam bucket","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iwB21Tf0h6"}],"key":"lc6rHACvNo"},{"type":"text","value":", with the data organized as:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L0BtKnHFwf"}],"key":"KFAXHwycrt"},{"type":"code","lang":"","value":"s3://s3-radaresideam/l2_data/year/month/date/radar_name/{radar_name[:3].upper()}{year}{month}{date}{hour}{minute}{second}.RAW*","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"key":"RA7ClJ4OQi"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We can use ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UQTLY5hHkE"},{"type":"link","url":"https://filesystem-spec.readthedocs.io/en/latest/","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"fsspec","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BTHqYXkNI0"}],"urlSource":"https://filesystem-spec.readthedocs.io/en/latest/","key":"OPDcd055Wi"},{"type":"text","value":", a tool to work with filesystems in Python, to search through the bucket to find our files!","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aU05KYORg1"}],"key":"bsZHSg7sSV"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"We start first by setting up our ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Q5WXirh4nx"},{"type":"link","url":"https://aws.amazon.com/s3/","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"AWS S3 filesystem","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"n3XSENQbx0"}],"urlSource":"https://aws.amazon.com/s3/","key":"zAW8OqL0xE"}],"key":"G8hiJjfbqe"}],"key":"QuXHL1OxI2"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fs = fsspec.filesystem(\"s3\", anon=True)","visibility":"show","key":"QjGjqAcsHb"},{"type":"output","id":"ZzheSdCv7seL6X1rWh44t","data":[],"visibility":"show","key":"XZAuXxSmkC"}],"visibility":"show","key":"EiJ99WLjPw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, we can list files from August 9, 2022, from Carimagua radar (CAR), around 1900 UTC.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XC5VIRaIRL"}],"key":"iY57VCyT7a"}],"key":"iwg8urgyI5"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"files = sorted(fs.glob(\"s3-radaresideam/l2_data/2022/08/09/Carimagua/CAR22080919*\"))\nfiles[:4]","visibility":"show","key":"IGzilRlmKq"},{"type":"output","id":"ahmCBRyzHmWDx7xukFZgQ","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"['s3-radaresideam/l2_data/2022/08/09/Carimagua/CAR220809190003.RAWDSVV',\n 's3-radaresideam/l2_data/2022/08/09/Carimagua/CAR220809190315.RAWDSW0',\n 's3-radaresideam/l2_data/2022/08/09/Carimagua/CAR220809190401.RAWDSW3',\n 's3-radaresideam/l2_data/2022/08/09/Carimagua/CAR220809190505.RAWDSW8']","content_type":"text/plain"}}}],"visibility":"show","key":"Wr8jIZpV3U"}],"visibility":"show","key":"buUHwOuaYu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read the data into Py-ART","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EQyUOeJohj"}],"identifier":"read-the-data-into-py-art","label":"Read the data into Py-ART","html_id":"read-the-data-into-py-art","implicit":true,"key":"o93g9lCDDd"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"When reading into Py-ART, we can use the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bGstVINwh7"},{"type":"inlineCode","value":"pyart.io.read_sigmet","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pNEObN7m49"},{"type":"text","value":" or ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vya0mlfWmO"},{"type":"inlineCode","value":"pyart.io.read","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pKJnOUKCsw"},{"type":"text","value":" module to read in our data.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"f1dMDejY7t"}],"key":"d7Vx8KyLNX"}],"key":"WwH1XXqwEX"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"radar = pyart.io.read_sigmet(f's3://{files[7]}')","visibility":"show","key":"LbJFDTIO5M"},{"type":"output","id":"IHnf_sWnNb8EK8kvun0xH","data":[],"visibility":"show","key":"aiI2Va9Zmc"}],"visibility":"show","key":"prMNxVJ0hU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"List the available fields","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B4fpSSqUea"}],"identifier":"list-the-available-fields","label":"List the available fields","html_id":"list-the-available-fields","implicit":true,"key":"lgCHFsRwg7"}],"key":"MWf2wZMZ9k"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"sorted(list(radar.fields))","visibility":"show","key":"QXivPfkCLZ"},{"type":"output","id":"DyAEZYvgRwqHWKboMxDQ3","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"['cross_correlation_ratio',\n 'differential_phase',\n 'differential_reflectivity',\n 'normalized_coherent_power',\n 'radar_echo_classification',\n 'reflectivity',\n 'specific_differential_phase',\n 'spectrum_width',\n 'total_power',\n 'velocity']","content_type":"text/plain"}}}],"visibility":"show","key":"dM1wljNrql"}],"visibility":"show","key":"R8l3QrFvMf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot dual-pol variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FPmkEVP4GA"}],"identifier":"plot-dual-pol-variables","label":"Plot dual-pol variables","html_id":"plot-dual-pol-variables","implicit":true,"key":"IMF45zUiyr"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Let’s plot the radar reflectivity (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ohzgBqOkYJ"},{"type":"inlineMath","value":"Z","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"PFdmbz041u"},{"type":"text","value":"), differential reflectivity (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"cwGb3RW5yr"},{"type":"inlineMath","value":"Z_{DR}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>D</mi><mi>R</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Z_{DR}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fDB2iYXx4t"},{"type":"text","value":"), specific differential phase (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"W7SxJVc6jS"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qK3XRMHpNJ"},{"type":"text","value":"), and cross correlation ratio (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MQY8D9JfxW"},{"type":"inlineMath","value":"\\rho_{HV}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>H</mi><mi>V</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\rho_{HV}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RmhzqCkH9X"},{"type":"text","value":") using a four panel plot.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OqCTiw7HND"}],"key":"hZoT60LfKn"}],"key":"o2fD7BcQtx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(12,10))\ndisplay = pyart.graph.RadarMapDisplay(radar)\n# Extract the latitude and longitude of the radar and use it for the center of the map\nlat_center = round(radar.latitude['data'][0], 0)\nlon_center = round(radar.longitude['data'][0], 0)\n\n\n# Determine the ticks\nlat_ticks = np.arange(lat_center-3, lat_center+3, 1.5)\nlon_ticks = np.arange(lon_center-3, lon_center+3, 1.5)\n\n# Set the projection - in this case, we use a general PlateCarree projection\nprojection = ccrs.PlateCarree()\nax1 = plt.subplot(221, projection=projection)\ndisplay.plot_ppi_map(\"reflectivity\", 0, \n                     resolution='10m', \n                     ax=ax1, \n                     lat_lines=lat_ticks, \n                     lon_lines=lon_ticks)\n\nax2 = plt.subplot(222, projection=projection)\ndisplay.plot_ppi_map(\"differential_reflectivity\", 0, \n                     resolution='10m', \n                     ax=ax2, \n                     lat_lines=lat_ticks, \n                     lon_lines=lon_ticks)\n\nax3 = plt.subplot(223, projection=projection)\ndisplay.plot_ppi_map(\"differential_phase\", 0, \n                     vmin=0, vmax=180,  \n                     ax=ax3, resolution='10m', \n                     lat_lines=lat_ticks, \n                     lon_lines=lon_ticks)\n\nax4 = plt.subplot(224, projection=projection)\ndisplay.plot_ppi_map(\"specific_differential_phase\", 0, \n                     vmin=0, vmax=10,  \n                     ax=ax4, resolution='10m', \n                     lat_lines=lat_ticks, \n                     lon_lines=lon_ticks)\nplt.tight_layout()","visibility":"show","key":"tFoj3BJLUk"},{"type":"output","id":"LGnVg9wWfjBaCaWj0zSM0","data":[{"output_type":"stream","name":"stdout","text":"Error in callback <function _draw_all_if_interactive at 0x7fafeb746fc0> (for post_execute), with arguments args (),kwargs {}:\n"},{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31merror\u001b[39m                                     Traceback (most recent call last)\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/pyplot.py:279\u001b[39m, in \u001b[36m_draw_all_if_interactive\u001b[39m\u001b[34m()\u001b[39m\n\u001b[32m    277\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m_draw_all_if_interactive\u001b[39m() -> \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m    278\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m matplotlib.is_interactive():\n\u001b[32m--> \u001b[39m\u001b[32m279\u001b[39m         \u001b[43mdraw_all\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/_pylab_helpers.py:131\u001b[39m, in \u001b[36mGcf.draw_all\u001b[39m\u001b[34m(cls, force)\u001b[39m\n\u001b[32m    129\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m manager \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mcls\u001b[39m.get_all_fig_managers():\n\u001b[32m    130\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m force \u001b[38;5;129;01mor\u001b[39;00m manager.canvas.figure.stale:\n\u001b[32m--> \u001b[39m\u001b[32m131\u001b[39m         \u001b[43mmanager\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcanvas\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw_idle\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/backend_bases.py:1893\u001b[39m, in \u001b[36mFigureCanvasBase.draw_idle\u001b[39m\u001b[34m(self, *args, **kwargs)\u001b[39m\n\u001b[32m   1891\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m._is_idle_drawing:\n\u001b[32m   1892\u001b[39m     \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m._idle_draw_cntx():\n\u001b[32m-> \u001b[39m\u001b[32m1893\u001b[39m         \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py:382\u001b[39m, in \u001b[36mFigureCanvasAgg.draw\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    379\u001b[39m \u001b[38;5;66;03m# Acquire a lock on the shared font cache.\u001b[39;00m\n\u001b[32m    380\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m (\u001b[38;5;28mself\u001b[39m.toolbar._wait_cursor_for_draw_cm() \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.toolbar\n\u001b[32m    381\u001b[39m       \u001b[38;5;28;01melse\u001b[39;00m nullcontext()):\n\u001b[32m--> \u001b[39m\u001b[32m382\u001b[39m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mfigure\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    383\u001b[39m     \u001b[38;5;66;03m# A GUI class may be need to update a window using this draw, so\u001b[39;00m\n\u001b[32m    384\u001b[39m     \u001b[38;5;66;03m# don't forget to call the superclass.\u001b[39;00m\n\u001b[32m    385\u001b[39m     \u001b[38;5;28msuper\u001b[39m().draw()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/artist.py:94\u001b[39m, in \u001b[36m_finalize_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer, *args, **kwargs)\u001b[39m\n\u001b[32m     92\u001b[39m \u001b[38;5;129m@wraps\u001b[39m(draw)\n\u001b[32m     93\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mdraw_wrapper\u001b[39m(artist, renderer, *args, **kwargs):\n\u001b[32m---> \u001b[39m\u001b[32m94\u001b[39m     result = \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     95\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m renderer._rasterizing:\n\u001b[32m     96\u001b[39m         renderer.stop_rasterizing()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/artist.py:71\u001b[39m, in \u001b[36mallow_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer)\u001b[39m\n\u001b[32m     68\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m     69\u001b[39m         renderer.start_filter()\n\u001b[32m---> \u001b[39m\u001b[32m71\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     73\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/figure.py:3257\u001b[39m, in \u001b[36mFigure.draw\u001b[39m\u001b[34m(self, renderer)\u001b[39m\n\u001b[32m   3254\u001b[39m             \u001b[38;5;66;03m# ValueError can occur when resizing a window.\u001b[39;00m\n\u001b[32m   3256\u001b[39m     \u001b[38;5;28mself\u001b[39m.patch.draw(renderer)\n\u001b[32m-> \u001b[39m\u001b[32m3257\u001b[39m     \u001b[43mmimage\u001b[49m\u001b[43m.\u001b[49m\u001b[43m_draw_list_compositing_images\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   3258\u001b[39m \u001b[43m        \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43martists\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43msuppressComposite\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   3260\u001b[39m     renderer.close_group(\u001b[33m'\u001b[39m\u001b[33mfigure\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m   3261\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/image.py:134\u001b[39m, in \u001b[36m_draw_list_compositing_images\u001b[39m\u001b[34m(renderer, parent, artists, suppress_composite)\u001b[39m\n\u001b[32m    132\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m not_composite \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m has_images:\n\u001b[32m    133\u001b[39m     \u001b[38;5;28;01mfor\u001b[39;00m a \u001b[38;5;129;01min\u001b[39;00m artists:\n\u001b[32m--> \u001b[39m\u001b[32m134\u001b[39m         \u001b[43ma\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    135\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    136\u001b[39m     \u001b[38;5;66;03m# Composite any adjacent images together\u001b[39;00m\n\u001b[32m    137\u001b[39m     image_group = []\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/artist.py:71\u001b[39m, in \u001b[36mallow_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer)\u001b[39m\n\u001b[32m     68\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m     69\u001b[39m         renderer.start_filter()\n\u001b[32m---> \u001b[39m\u001b[32m71\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     73\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/cartopy/mpl/geoaxes.py:509\u001b[39m, in \u001b[36mGeoAxes.draw\u001b[39m\u001b[34m(self, renderer, **kwargs)\u001b[39m\n\u001b[32m    504\u001b[39m         \u001b[38;5;28mself\u001b[39m.imshow(img, extent=extent, origin=origin,\n\u001b[32m    505\u001b[39m                     transform=factory.crs, *factory_args[\u001b[32m1\u001b[39m:],\n\u001b[32m    506\u001b[39m                     **factory_kwargs)\n\u001b[32m    507\u001b[39m \u001b[38;5;28mself\u001b[39m._done_img_factory = \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m509\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m=\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/artist.py:71\u001b[39m, in \u001b[36mallow_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer)\u001b[39m\n\u001b[32m     68\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m     69\u001b[39m         renderer.start_filter()\n\u001b[32m---> \u001b[39m\u001b[32m71\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     73\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/axes/_base.py:3226\u001b[39m, in \u001b[36m_AxesBase.draw\u001b[39m\u001b[34m(self, renderer)\u001b[39m\n\u001b[32m   3223\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m artists_rasterized:\n\u001b[32m   3224\u001b[39m     _draw_rasterized(\u001b[38;5;28mself\u001b[39m.get_figure(root=\u001b[38;5;28;01mTrue\u001b[39;00m), artists_rasterized, renderer)\n\u001b[32m-> \u001b[39m\u001b[32m3226\u001b[39m \u001b[43mmimage\u001b[49m\u001b[43m.\u001b[49m\u001b[43m_draw_list_compositing_images\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   3227\u001b[39m \u001b[43m    \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43martists\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mget_figure\u001b[49m\u001b[43m(\u001b[49m\u001b[43mroot\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43msuppressComposite\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   3229\u001b[39m renderer.close_group(\u001b[33m'\u001b[39m\u001b[33maxes\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m   3230\u001b[39m \u001b[38;5;28mself\u001b[39m.stale = \u001b[38;5;28;01mFalse\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/image.py:134\u001b[39m, in \u001b[36m_draw_list_compositing_images\u001b[39m\u001b[34m(renderer, parent, artists, suppress_composite)\u001b[39m\n\u001b[32m    132\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m not_composite \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m has_images:\n\u001b[32m    133\u001b[39m     \u001b[38;5;28;01mfor\u001b[39;00m a \u001b[38;5;129;01min\u001b[39;00m artists:\n\u001b[32m--> \u001b[39m\u001b[32m134\u001b[39m         \u001b[43ma\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    135\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    136\u001b[39m     \u001b[38;5;66;03m# Composite any adjacent images together\u001b[39;00m\n\u001b[32m    137\u001b[39m     image_group = []\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/matplotlib/artist.py:71\u001b[39m, in \u001b[36mallow_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer)\u001b[39m\n\u001b[32m     68\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m     69\u001b[39m         renderer.start_filter()\n\u001b[32m---> \u001b[39m\u001b[32m71\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     73\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:184\u001b[39m, in \u001b[36mFeatureArtist.draw\u001b[39m\u001b[34m(self, renderer)\u001b[39m\n\u001b[32m    179\u001b[39m     geoms = \u001b[38;5;28mself\u001b[39m._feature.geometries()\n\u001b[32m    180\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    181\u001b[39m     \u001b[38;5;66;03m# For efficiency on local maps with high resolution features (e.g\u001b[39;00m\n\u001b[32m    182\u001b[39m     \u001b[38;5;66;03m# from Natural Earth), only create paths for geometries that are\u001b[39;00m\n\u001b[32m    183\u001b[39m     \u001b[38;5;66;03m# in view.\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m184\u001b[39m     geoms = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_feature\u001b[49m\u001b[43m.\u001b[49m\u001b[43mintersecting_geometries\u001b[49m\u001b[43m(\u001b[49m\u001b[43mextent\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    186\u001b[39m stylised_paths = {}\n\u001b[32m    187\u001b[39m \u001b[38;5;66;03m# Make an empty placeholder style dictionary for when styler is not\u001b[39;00m\n\u001b[32m    188\u001b[39m \u001b[38;5;66;03m# used.  Freeze it so that we can use it as a dict key.  We will need\u001b[39;00m\n\u001b[32m    189\u001b[39m \u001b[38;5;66;03m# to unfreeze all style dicts with dict(frozen) before passing to mpl.\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/cartopy/feature/__init__.py:312\u001b[39m, in \u001b[36mNaturalEarthFeature.intersecting_geometries\u001b[39m\u001b[34m(self, extent)\u001b[39m\n\u001b[32m    305\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    306\u001b[39m \u001b[33;03mReturns an iterator of shapely geometries that intersect with\u001b[39;00m\n\u001b[32m    307\u001b[39m \u001b[33;03mthe given extent.\u001b[39;00m\n\u001b[32m    308\u001b[39m \u001b[33;03mThe extent is assumed to be in the CRS of the feature.\u001b[39;00m\n\u001b[32m    309\u001b[39m \u001b[33;03mIf extent is None, the method returns all geometries for this dataset.\u001b[39;00m\n\u001b[32m    310\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    311\u001b[39m \u001b[38;5;28mself\u001b[39m.scaler.scale_from_extent(extent)\n\u001b[32m--> \u001b[39m\u001b[32m312\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mintersecting_geometries\u001b[49m\u001b[43m(\u001b[49m\u001b[43mextent\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/cartopy/feature/__init__.py:112\u001b[39m, in \u001b[36mFeature.intersecting_geometries\u001b[39m\u001b[34m(self, extent)\u001b[39m\n\u001b[32m    109\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m extent \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m np.isnan(extent[\u001b[32m0\u001b[39m]):\n\u001b[32m    110\u001b[39m     extent_geom = sgeom.box(extent[\u001b[32m0\u001b[39m], extent[\u001b[32m2\u001b[39m],\n\u001b[32m    111\u001b[39m                             extent[\u001b[32m1\u001b[39m], extent[\u001b[32m3\u001b[39m])\n\u001b[32m--> \u001b[39m\u001b[32m112\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m (geom \u001b[38;5;28;01mfor\u001b[39;00m geom \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mgeometries\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mif\u001b[39;00m\n\u001b[32m    113\u001b[39m             geom \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m extent_geom.intersects(geom))\n\u001b[32m    114\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    115\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m.geometries()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/cartopy/feature/__init__.py:297\u001b[39m, in \u001b[36mNaturalEarthFeature.geometries\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    295\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m reader.crs \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m    296\u001b[39m         \u001b[38;5;28mself\u001b[39m._crs = reader.crs\n\u001b[32m--> \u001b[39m\u001b[32m297\u001b[39m     geometries = \u001b[38;5;28;43mtuple\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mreader\u001b[49m\u001b[43m.\u001b[49m\u001b[43mgeometries\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    298\u001b[39m     _NATURAL_EARTH_GEOM_CACHE[key] = geometries\n\u001b[32m    299\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/cartopy/io/shapereader.py:173\u001b[39m, in \u001b[36mBasicReader.geometries\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    161\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mgeometries\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[32m    162\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    163\u001b[39m \u001b[33;03m    Return an iterator of shapely geometries from the shapefile.\u001b[39;00m\n\u001b[32m    164\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    171\u001b[39m \n\u001b[32m    172\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m173\u001b[39m \u001b[43m    \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mshape\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_reader\u001b[49m\u001b[43m.\u001b[49m\u001b[43miterShapes\u001b[49m\u001b[43m(\u001b[49m\u001b[43mbbox\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_bbox\u001b[49m\u001b[43m)\u001b[49m\u001b[43m:\u001b[49m\n\u001b[32m    174\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# Skip the shape that can not be represented as geometry.\u001b[39;49;00m\n\u001b[32m    175\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;28;43;01mif\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mshape\u001b[49m\u001b[43m.\u001b[49m\u001b[43mshapeType\u001b[49m\u001b[43m \u001b[49m\u001b[43m!=\u001b[49m\u001b[43m \u001b[49m\u001b[43mshapefile\u001b[49m\u001b[43m.\u001b[49m\u001b[43mNULL\u001b[49m\u001b[43m:\u001b[49m\n\u001b[32m    176\u001b[39m \u001b[43m            \u001b[49m\u001b[38;5;28;43;01myield\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43msgeom\u001b[49m\u001b[43m.\u001b[49m\u001b[43mshape\u001b[49m\u001b[43m(\u001b[49m\u001b[43mshape\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/shapefile.py:2806\u001b[39m, in \u001b[36mReader.iterShapes\u001b[39m\u001b[34m(self, bbox)\u001b[39m\n\u001b[32m   2802\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.numShapes:\n\u001b[32m   2803\u001b[39m     \u001b[38;5;66;03m# Iterate exactly the number of shapes from shx header\u001b[39;00m\n\u001b[32m   2804\u001b[39m     \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;28mself\u001b[39m.numShapes):\n\u001b[32m   2805\u001b[39m         \u001b[38;5;66;03m# MAYBE: check if more left of file or exit early?\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m2806\u001b[39m         shape = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m__shape\u001b[49m\u001b[43m(\u001b[49m\u001b[43moid\u001b[49m\u001b[43m=\u001b[49m\u001b[43mi\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbbox\u001b[49m\u001b[43m=\u001b[49m\u001b[43mbbox\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   2807\u001b[39m         \u001b[38;5;28;01mif\u001b[39;00m shape:\n\u001b[32m   2808\u001b[39m             \u001b[38;5;28;01myield\u001b[39;00m shape\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/shapefile.py:2684\u001b[39m, in \u001b[36mReader.__shape\u001b[39m\u001b[34m(self, oid, bbox)\u001b[39m\n\u001b[32m   2681\u001b[39m shapeType = unpack(\u001b[33m\"\u001b[39m\u001b[33m<i\u001b[39m\u001b[33m\"\u001b[39m, b_io.read(\u001b[32m4\u001b[39m))[\u001b[32m0\u001b[39m]\n\u001b[32m   2683\u001b[39m ShapeClass = SHAPE_CLASS_FROM_SHAPETYPE[shapeType]\n\u001b[32m-> \u001b[39m\u001b[32m2684\u001b[39m shape = \u001b[43mShapeClass\u001b[49m\u001b[43m.\u001b[49m\u001b[43mfrom_byte_stream\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   2685\u001b[39m \u001b[43m    \u001b[49m\u001b[43mshapeType\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb_io\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrecLength_bytes\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43moid\u001b[49m\u001b[43m=\u001b[49m\u001b[43moid\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbbox\u001b[49m\u001b[43m=\u001b[49m\u001b[43mbbox\u001b[49m\n\u001b[32m   2686\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   2688\u001b[39m \u001b[38;5;66;03m# Seek to the end of this record as defined by the record header because\u001b[39;00m\n\u001b[32m   2689\u001b[39m \u001b[38;5;66;03m# the shapefile spec doesn't require the actual content to meet the header\u001b[39;00m\n\u001b[32m   2690\u001b[39m \u001b[38;5;66;03m# definition.  Probably allowed for lazy feature deletion.\u001b[39;00m\n\u001b[32m   2691\u001b[39m \u001b[38;5;66;03m# f.seek(next_shape)\u001b[39;00m\n\u001b[32m   2693\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m shape\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/shapefile.py:1194\u001b[39m, in \u001b[36m_CanHaveBBox.from_byte_stream\u001b[39m\u001b[34m(cls, shapeType, b_io, next_shape, oid, bbox)\u001b[39m\n\u001b[32m   1188\u001b[39m \u001b[38;5;66;03m# else:\u001b[39;00m\n\u001b[32m   1189\u001b[39m \u001b[38;5;66;03m#     parts = None\u001b[39;00m\n\u001b[32m   1190\u001b[39m \u001b[38;5;66;03m#     partTypes = None\u001b[39;00m\n\u001b[32m   1192\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m nPoints:\n\u001b[32m   1193\u001b[39m     kwargs[\u001b[33m\"\u001b[39m\u001b[33mpoints\u001b[39m\u001b[33m\"\u001b[39m] = cast(\n\u001b[32m-> \u001b[39m\u001b[32m1194\u001b[39m         PointsT, \u001b[38;5;28;43mcls\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_read_points_from_byte_stream\u001b[49m\u001b[43m(\u001b[49m\u001b[43mb_io\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnPoints\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1195\u001b[39m     )\n\u001b[32m   1197\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m shapeType \u001b[38;5;129;01min\u001b[39;00m _HasZ_shapeTypes:\n\u001b[32m   1198\u001b[39m         kwargs[\u001b[33m\"\u001b[39m\u001b[33mzbox\u001b[39m\u001b[33m\"\u001b[39m], kwargs[\u001b[33m\"\u001b[39m\u001b[33mz\u001b[39m\u001b[33m\"\u001b[39m] = _HasZ._read_zs_from_byte_stream(\n\u001b[32m   1199\u001b[39m             b_io, nPoints\n\u001b[32m   1200\u001b[39m         )\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.12/site-packages/shapefile.py:1136\u001b[39m, in \u001b[36m_CanHaveBBox._read_points_from_byte_stream\u001b[39m\u001b[34m(b_io, nPoints)\u001b[39m\n\u001b[32m   1132\u001b[39m \u001b[38;5;129m@staticmethod\u001b[39m\n\u001b[32m   1133\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m_read_points_from_byte_stream\u001b[39m(\n\u001b[32m   1134\u001b[39m     b_io: ReadableBinStream, nPoints: \u001b[38;5;28mint\u001b[39m\n\u001b[32m   1135\u001b[39m ) -> \u001b[38;5;28mlist\u001b[39m[Point2D]:\n\u001b[32m-> \u001b[39m\u001b[32m1136\u001b[39m     flat = \u001b[43munpack\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43mf\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m<\u001b[39;49m\u001b[38;5;132;43;01m{\u001b[39;49;00m\u001b[32;43m2\u001b[39;49m\u001b[38;5;250;43m \u001b[39;49m\u001b[43m*\u001b[49m\u001b[38;5;250;43m \u001b[39;49m\u001b[43mnPoints\u001b[49m\u001b[38;5;132;43;01m}\u001b[39;49;00m\u001b[33;43md\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb_io\u001b[49m\u001b[43m.\u001b[49m\u001b[43mread\u001b[49m\u001b[43m(\u001b[49m\u001b[32;43m16\u001b[39;49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m \u001b[49m\u001b[43mnPoints\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1137\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mlist\u001b[39m(\u001b[38;5;28mzip\u001b[39m(*(\u001b[38;5;28miter\u001b[39m(flat),) * \u001b[32m2\u001b[39m))\n\n\u001b[31merror\u001b[39m: unpack requires a buffer of 23904 bytes","ename":"error","evalue":"unpack requires a buffer of 23904 bytes"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x1000 with 8 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ebb7ab36dceee99370f02f35069c8d78","path":"/radar-cookbook/build/ebb7ab36dceee99370f02f35069c8d78.png"}}}],"visibility":"show","key":"AhlMkIw9gK"}],"visibility":"show","key":"RKMr0XWRAo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can notice from the previous figure that this is a intense precipitation event in Colombia with reflectivity values up to +55 dBZ, big raindrops (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zU7ckwoVyr"},{"type":"inlineMath","value":"Z_{DR}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>D</mi><mi>R</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Z_{DR}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hXNQ40Oqxx"},{"type":"text","value":" +3 dB), heavy rainfall rates with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JUx2yQAwBr"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KoE4diV7hh"},{"type":"text","value":" +10 dB/km, and multiples foldings in differential phase (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gaRoBafhgW"},{"type":"inlineMath","value":"Phi_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mi>h</mi><msub><mi>i</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Phi_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">h</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"X2t85pztI2"},{"type":"text","value":"). We can notice negative values in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o3HChVvuEZ"},{"type":"inlineMath","value":"Z_{DR}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>D</mi><mi>R</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Z_{DR}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qAHjzDEt44"},{"type":"text","value":" panel (differential attenuation) in the north-east side of the radar location.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"epI1KycFbP"}],"key":"Hftd5GR9Sa"}],"key":"yDnBepJRuH"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"b3FomBb0HK"},{"type":"text","value":" retrieval methods","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UxWNfF6XNg"}],"identifier":"k-dp-retrieval-methods","label":"K_{DP} retrieval methods","html_id":"k-dp-retrieval-methods","implicit":true,"key":"C1DRctUWGD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Although the radar data already contains the specific differential phase (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t1EYSUtjrr"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jxucxPyBOS"},{"type":"text","value":"), we can use the following alternative methods for comparison:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jozr6WVm76"}],"key":"DroChjrqF1"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Variational method by Maesaka et al. (2012).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rH6dHMhD5Z"}],"key":"r8AfkEvCIs"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Kalman filter method by Schneebeli and al. (2014)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cT2V2gUoch"}],"key":"VUZw5pmW2Z"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Vulpiani method by Vulpiani et al. (2012)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"S0r3TERgys"}],"key":"qZX0CvoZSE"}],"key":"JJ4CBmwLTN"}],"visibility":"show","key":"OVIfsmavym"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pFvEj2HU1B"},{"type":"inlineCode","value":"Py-Art","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r3zPmxyejT"},{"type":"text","value":" Python package includes all the methods mentioned above. We can access the retrieval methods using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w2A50ZaJzR"},{"type":"inlineCode","value":"pyart.retrieve.kdp_maesaka","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PqxWxcjBMe"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tzoWg2XNYj"},{"type":"inlineCode","value":"pyart.retrieve.kdp_schneebeli","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oIzxFk2ie4"},{"type":"text","value":", and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OAI1QqO1Rn"},{"type":"inlineCode","value":"pyart.retrieve.kdp_vulpiani","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UBra6U8aDg"},{"type":"text","value":". The output from all retrieval methods is a tuple with two dictionaries that contain the retrieved ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MQaoulBwmU"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"q35qAzphn0"},{"type":"text","value":" as well as the Differential phase (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ge5ujrsiYc"},{"type":"inlineMath","value":"Phi_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mi>h</mi><msub><mi>i</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Phi_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">h</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gVz1bKPbq1"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HuBQDwvTeI"}],"key":"g028c7v5Rz"}],"visibility":"show","key":"UK1KT87p0A"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nkdp_maesaka= pyart.retrieve.kdp_maesaka(radar)","visibility":"show","key":"JuP8wsYUX0"},{"type":"output","id":"xeIz3fa8avspOcb2qXOwa","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 19.5 s, sys: 57.4 ms, total: 19.5 s\nWall time: 12.3 s\n"}],"visibility":"show","key":"STsdlWcPq8"}],"visibility":"show","key":"ux6ogdjc4n"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nkdp_schneebeli = pyart.retrieve.kdp_schneebeli(radar, band='C', parallel=True)","visibility":"show","key":"XN3CmoqPxM"},{"type":"output","id":"ni1hB_lRjrQBvNwdNvKkV","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 127 ms, sys: 349 ms, total: 476 ms\nWall time: 4min 6s\n"}],"visibility":"show","key":"aVb1v2lHlt"}],"visibility":"show","key":"uBl2QzcO6n"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nkdp_vulpiani = pyart.retrieve.kdp_vulpiani(radar, band='C', parallel=True)","visibility":"show","key":"TIdwpT9vXc"},{"type":"output","id":"BeJetbWiZM0eiDpNr5iBL","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 126 ms, sys: 329 ms, total: 455 ms\nWall time: 928 ms\n"}],"visibility":"show","key":"mOW6aJoSaO"}],"visibility":"show","key":"Ac1nJGtSew"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is how a dictionary with the retrieve ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z7u8yOsfdC"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xZ8owR2UXb"},{"type":"text","value":" looks like","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fFKrqOpUel"}],"key":"YOvLCHpsRr"}],"key":"XYGfqZTP6F"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"kdp_vulpiani[0]","visibility":"show","key":"AJnjHWwElm"},{"type":"output","id":"vzNjW87cWw8n3mNAolkLf","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"{'units': 'degrees/km',\n 'standard_name': 'specific_differential_phase_hv',\n 'long_name': 'Specific differential phase (KDP)',\n 'coordinates': 'elevation azimuth range',\n 'data': masked_array(\n   data=[[0.0, 0.0, 0.0, ..., --, --, --],\n         [0.0, 0.0, 0.0, ..., --, --, --],\n         [0.0, 0.0, 0.0, ..., --, --, --],\n         ...,\n         [0.0, 0.0, 0.0, ..., --, --, --],\n         [0.0, 0.0, 0.0, ..., --, --, --],\n         [0.0, 0.0, 0.0, ..., --, --, --]],\n   mask=[[False, False, False, ...,  True,  True,  True],\n         [False, False, False, ...,  True,  True,  True],\n         [False, False, False, ...,  True,  True,  True],\n         ...,\n         [False, False, False, ...,  True,  True,  True],\n         [False, False, False, ...,  True,  True,  True],\n         [False, False, False, ...,  True,  True,  True]],\n   fill_value=-9999.0)}","content_type":"text/plain"}}}],"visibility":"show","key":"UNRXCVgZP3"}],"visibility":"show","key":"BTzOtRvLAE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add the new retrieved ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BYZgs6S2P4"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Egf1fUSlHp"},{"type":"text","value":" values to the radar object","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l2nEVvvouk"}],"identifier":"add-the-new-retrieved-k-dp-values-to-the-radar-object","label":"Add the new retrieved K_{DP} values to the radar object","html_id":"add-the-new-retrieved-k-dp-values-to-the-radar-object","implicit":true,"key":"HjKiqzSIGI"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We can add new fields to our ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"szh2yrRkPU"},{"type":"inlineCode","value":"Py-Art","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QLUUfijDS2"},{"type":"text","value":" radar object by using the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DMxmWMgYmA"},{"type":"inlineCode","value":"pyart.core.Radar.add_field","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"n2ZKhkRqBW"},{"type":"text","value":" method as follows","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"k99v25xpKB"}],"key":"jSo4nlHBiD"}],"key":"Gg9iGT9BDd"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"radar.add_field('kdp_maesaka', kdp_maesaka[0])\nradar.add_field('phidp_maesaka', kdp_maesaka[1])\nradar.add_field('kdp_schneebeli', kdp_schneebeli[0])\nradar.add_field('phidp_schneebeli', kdp_schneebeli[1])\nradar.add_field('kdp_vulpiani', kdp_vulpiani[0])\nradar.add_field('phidp_vulpiani', kdp_vulpiani[1])","visibility":"show","key":"z78nLbXMhc"},{"type":"output","id":"T0VhAWSYHhAnc5FVQzFd9","data":[],"visibility":"show","key":"h4JDd0uwIt"}],"visibility":"show","key":"S7VSypPBo2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"List the new fields/variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aai67ZC7RO"}],"identifier":"list-the-new-fields-variables","label":"List the new fields/variables","html_id":"list-the-new-fields-variables","implicit":true,"key":"s871sGuhaj"}],"key":"ZM0Cnd6VCE"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"sorted(list(radar.fields))","visibility":"show","key":"XQqckHGsJT"},{"type":"output","id":"n4-Uoqa321tlKkA75prKw","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"['cross_correlation_ratio',\n 'differential_phase',\n 'differential_reflectivity',\n 'kdp_maesaka',\n 'kdp_schneebeli',\n 'kdp_vulpiani',\n 'normalized_coherent_power',\n 'phidp_maesaka',\n 'phidp_schneebeli',\n 'phidp_vulpiani',\n 'radar_echo_classification',\n 'reflectivity',\n 'specific_differential_phase',\n 'spectrum_width',\n 'total_power',\n 'velocity']","content_type":"text/plain"}}}],"visibility":"show","key":"IKXqgag5l0"}],"visibility":"show","key":"Jm0SQ5iZj1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare default and retrieved ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EyvgUa7264"},{"type":"inlineMath","value":"Phi_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mi>h</mi><msub><mi>i</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Phi_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">h</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YuepLABFme"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aeplvlfn2p"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ToeSLYEjZw"}],"identifier":"compare-default-and-retrieved-phi-dp-and-k-dp","label":"Compare default and retrieved Phi_{DP} and K_{DP}","html_id":"compare-default-and-retrieved-phi-dp-and-k-dp","implicit":true,"key":"c8k0yQ4EyZ"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We can look at the difference between all the methods using a side-by-side comparison figure","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wxfQLBawZK"}],"key":"kDXNlWZ5Ov"}],"key":"BgYH1wn99R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# list of the variables to be plotted\nvpol = ['specific_differential_phase', 'kdp_maesaka', 'kdp_schneebeli', 'kdp_vulpiani',\n        'differential_phase', 'phidp_maesaka', 'phidp_schneebeli', 'phidp_vulpiani']\n# list of cmaps\ncmaps = ['Carbone42'] * 4 + ['Wild25'] * 4\n\n# list of maximum values\nvmaxs = [10] * 4 + [180]  * 4 \n\n# list of tltles\ntitles = [r\"$K_{DP} \\ Default$\", r\"$K_{DP} \\ Maesaka$\", r\"$K_{DP} \\ Schneebeli$\", r\"$K_{DP} \\ Vulpiani$\", \n          r\"$Phi_{DP} \\ Default$\", r\"$Phi_{DP} \\ Maesaka$\", r\"$Phi_{DP} \\ Schneebeli$\", r\"$Phi_{DP} \\ Vulpiani$\"]\n\n# display object from PyArt\ndisplay = pyart.graph.RadarMapDisplay(radar)\nfig, axs = plt.subplots(2, 4, figsize=(14,6), subplot_kw={'projection': ccrs.PlateCarree()}, sharey=True, sharex=True)\n\n# Extract the latitude and longitude of the radar and use it for the center of the map\nlat_center = round(radar.latitude['data'][0], 0)\nlon_center = round(radar.longitude['data'][0], 0)\n\n# Set the projection - in this case, we use a general PlateCarree projection\nprojection = ccrs.PlateCarree()\n\n# Determine the ticks\nlat_ticks = np.arange(lat_center-3, lat_center+3, 1.5)\nlon_ticks = np.arange(lon_center-3, lon_center+3, 1.5)\n\n#make axis flatten for iteration\naxis = axs.flatten()\n# Loop to create all plots\nfor idx, ax in enumerate(axis):\n    display.plot_ppi_map(vpol[idx], 0, resolution='10m', ax=ax, \n                         lat_lines=lat_ticks, \n                         lon_lines=lon_ticks,\n                         cmap=cmaps[idx],\n                         vmin=0, \n                         vmax=vmaxs[idx],\n                         colorbar_flag=False, \n                         title_flag=False, \n                         add_grid_lines=False)\n    ax.set_title(titles[idx])\n    gl = ax.gridlines(draw_labels=True, rasterized=True)\n    gl.xlocator = mticker.FixedLocator(lon_ticks)\n    gl.ylabels_right = False\n    gl.xlabels_top = False\n    gl.ylabels_left = False\n    gl.xlabels_bottom = False\n    if (idx == 0) | (idx== 4):\n        gl.ylabels_left = True\n    if  idx>= 4:\n        gl.xlabels_bottom = True\n\nfig.tight_layout()\nfig.colorbar(display.plots[0], ax=axis[:4], pad=.01, label='$Specific \\ differential \\  phase  \\ [deg/km]$')\nfig.colorbar(display.plots[-1], ax=axis[-4:], pad=.01, label='$Differential \\ phase  \\ [deg]$')\n# fig.savefig('../images/kdp_comparison.jpg')","key":"DxA4RWpFAS"},{"type":"output","id":"IjBIheiQLkEE4j898-F9H","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1400x600 with 10 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"caf0d6975d485dff341e5b94c6a32252","path":"/radar-cookbook/build/caf0d6975d485dff341e5b94c6a32252.png"}}}],"key":"Z1v03nzD2r"}],"key":"SC1jgYrGXA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the top row, we can see the Specific Differential Phase (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eqNCXeYTTt"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gofFYX4M90"},{"type":"text","value":"), and in the bottom row, the Differential Phase (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XbZPlUl2Le"},{"type":"inlineMath","value":"Phi_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mi>h</mi><msub><mi>i</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Phi_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">h</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZPAhmtxdh5"},{"type":"text","value":"). We can notice that the default ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EPEsDzxs0w"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"x6VDj8Tq1H"},{"type":"text","value":" shows values +10 deg/km, which we think is too high. On the other hand, Maesake’s and Scneebeli’s methods’ output suggests that they are probably not performing well. However, the Vulpiani method performs better since we can observe more realistic values on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K23wVWiGl6"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TZiOsKfA1f"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hh8NXI7wUB"},{"type":"inlineMath","value":"Phi_{DP}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mi>h</mi><msub><mi>i</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Phi_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">h</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"frXanCXCLx"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JnEcPqNeyW"}],"key":"veq3XPapkM"}],"key":"SACpebzESt"},{"type":"block","kind":"notebook-content","children":[{"type":"div","class":"admonition alert alert-warning","children":[{"type":"paragraph","children":[{"type":"text","value":"Warning","key":"lBxby3hui6"}],"key":"d0FAw8kAcN"},{"type":"text","value":"This notebook is intended to be demonstrative; therefore, we can not make any conclusions regarding the methods we tested.","key":"uQnGpbQcxn"}],"key":"ZakEXb6iwE"}],"key":"YddblXjRtT"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZXwal5kRRM"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bXAzmZwoEm"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"sRUv2K4HqV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Within this example, we walked through how to access Colombian radar data from IDEAM, plot a quick look of the data, and compare the the specific differential phase using the default and three different methods!","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NZglcX2ViB"}],"key":"EQ86AxKyns"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"What’s Next?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eVJ32DeRGi"}],"identifier":"whats-next","label":"What’s Next?","html_id":"whats-next","implicit":true,"key":"Rw6pA7lOhE"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We will showcase other data workflow examples, including field campaigns in other regions and data access methods from other data centers.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uQGLk2TEcy"}],"key":"YcjxoX02xm"}],"key":"vBsvQH8JkV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and References","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rmwxqKsrQK"}],"identifier":"resources-and-references","label":"Resources and References","html_id":"resources-and-references","implicit":true,"key":"Vz6vAbJ4xR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"link","url":"https://registry.opendata.aws/ideam-radares/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"IDEAM radar data","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FK0EzziBjq"}],"urlSource":"https://registry.opendata.aws/ideam-radares/","key":"HsE73GrisC"}],"key":"yMccuI5FGE"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Py-ART:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nH8oofm5l4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Helmus, J.J. & Collis, S.M., (2016). The Python ","key":"ohGbs9MtKQ"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"eD9gcnhBaV"}],"key":"o1dtJp8ogi"},{"type":"text","value":" Radar Toolkit (Py-ART), a Library for Working with Weather Radar Data in the Python Programming Language. Journal of Open Research Software. 4(1), p.e25. DOI: ","key":"Zqfvh5Z5aI"},{"type":"cite","url":"http://doi.org/10.5334/jors.119","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Helmus & Collis (2016)","key":"t4FRnCgO9s"}],"kind":"narrative","label":"Helmus_2016","identifier":"http://doi.org/10.5334/jors.119","enumerator":"1","key":"TgRU96ZgPO"}],"key":"l44kM1QrCu"}],"key":"NIiVrHwHKy"}],"key":"c1SbFDtNsA"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"ACT:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EZBIFxlVIh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Adam Theisen, Ken Kehoe, Zach Sherman, Bobby Jackson, Alyssa Sockol, Corey Godine, Max Grover, Jason Hemedinger, Jenni Kyrouac, Maxwell Levin, Michael Giansiracusa (2022). The Atmospheric Data Community Toolkit (ACT). Zenodo. DOI: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RWkwKs8PvL"},{"type":"cite","url":"https://doi.org/10.5281/zenodo.6712343","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Theisen ","key":"EWKPXipquc"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"sst3yxxtf1"}],"key":"JfyLHHSugs"},{"type":"text","value":" (2022)","key":"RNZIV91aeB"}],"kind":"narrative","label":"https://doi.org/10.5281/zenodo.6712343","identifier":"https://doi.org/10.5281/zenodo.6712343","enumerator":"2","key":"Pde44n1Qad"}],"key":"u8VuO2rg7v"}],"key":"R8GFNTlCBT"}],"key":"GzZTNb3AcE"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Maesaka, T., Iwanami, K. and Maki, M., 2012: Non-negative KDP Estimation by Monotone Increasing PHIDP Assumption below Melting Layer. The Seventh European Conference on Radar in Meteorology and Hydrology.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SfOkJJGIHt"}],"key":"HBSc4f0Wzt"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Schneebeli, M., Grazioli, J., and Berne, A., 2014: Improved Estimation of the Specific Differential Phase SHIFT Using a Compilation of Kalman Filter Ensembles, IEEE T. Geosci. Remote Sens., 52, 5137-5149, https://doi:10.1109/TGRS.2013.2287017","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BWXwHOfzag"}],"key":"KGHpuze1Pr"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Gianfranco Vulpiani, Mario Montopoli, Luca Delli Passeri, Antonio G. Gioia, Pietro Giordano, and Frank S. Marzano, 2012: On the Use of Dual-Polarized C-Band Radar for Operational Rainfall Retrieval in Mountainous Areas. J. Appl. Meteor. Climatol., 51, 405-425, doi: ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RpU7G2OIuz"},{"type":"link","url":"https://10.1175/JAMC-D-10-05024.1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"https://​10​.1175​/JAMC​-D​-10​-05024.1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EzG92S13lb"}],"urlSource":"https://10.1175/JAMC-D-10-05024.1","key":"kxYPZgJWaj"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"WmUoZBE3hc"}],"key":"fbsam2AGEN"}],"key":"VlgFX2X7J8"}],"key":"eyYqZxcu3l"}],"key":"tqk2UxFLjl"},"references":{"cite":{"order":["Helmus_2016","https://doi.org/10.5281/zenodo.6712343"],"data":{"Helmus_2016":{"label":"Helmus_2016","enumerator":"1","doi":"10.5334/jors.119","html":"Helmus, J. J., & Collis, S. M. (2016). The Python ARM Radar Toolkit (Py-ART), a Library for Working with Weather Radar Data in the Python Programming Language. <i>Journal of Open Research Software</i>, <i>4</i>(1), 25. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5334/jors.119\">10.5334/jors.119</a>","url":"https://doi.org/10.5334/jors.119"},"https://doi.org/10.5281/zenodo.6712343":{"label":"https://doi.org/10.5281/zenodo.6712343","enumerator":"2","doi":"10.5281/ZENODO.6712343","html":"Theisen, A., Kehoe, K., Sherman, Z., Jackson, B., Sockol, A., Godine, C., Grover, M., Hemedinger, J., Kyrouac, J., Levin, M., & Giansiracusa, M. (2022). <i>ARM-DOE/ACT: ACT Release v1.1.9</i>. Zenodo. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5281/ZENODO.6712343\">10.5281/ZENODO.6712343</a>","url":"https://doi.org/10.5281/ZENODO.6712343"}}}},"footer":{"navigation":{"prev":{"title":"Plotting Data from a Field Campaign (TRACER)","url":"/notebooks/example-workflows/tracer-example","group":"Example Workflows"},"next":{"title":"Data Quality Check from the CACTI Field Campaign","url":"/notebooks/example-workflows/cacti-data-quality-example","group":"Example Workflows"}}},"domain":"http://localhost:3000"}