{"version":2,"kind":"Notebook","sha256":"b9f84efa5e92bd2209cc84ba86e5b11602ef7f5a5b136c0168b5c5ff77900fe7","slug":"fastbarnes-interpolation-rhi","location":"/notebooks/example-workflows/fastbarnes_interpolation_rhi.ipynb","dependencies":[],"frontmatter":{"title":"2D objective analysis of weather radar RHI scan: Fast Barnes Interpolation Example","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Max Grover","given":"Max","family":"Grover"},"name":"Max Grover","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Zachary Sherman","given":"Zachary","family":"Sherman"},"name":"Zachary Sherman","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Milind Sharma","given":"Milind","family":"Sharma"},"name":"Milind Sharma","id":"contributors-myst-generated-uid-2"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/radar-cookbook","copyright":"2024","abbreviations":{"ARM":"Atmospheric Radiation Measurement"},"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/radar-cookbook/blob/HEAD/notebooks/example-workflows/fastbarnes_interpolation_rhi.ipynb","exports":[{"format":"ipynb","filename":"fastbarnes_interpolation_rhi.ipynb","url":"/radar-cookbook/build/fastbarnes_interpola-0e9f36671e240f9e1f1dd23ff01ee859.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This example uses the Fast Barnes interpolation methods as presented in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SGpFFLmCyr"},{"type":"cite","url":"https://doi.org/10.5194/gmd-16-1697-2023","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Zürcher (2023)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yOHHNGdi9U"}],"kind":"narrative","label":"Z_rcher_2023","identifier":"https://doi.org/10.5194/gmd-16-1697-2023","enumerator":"1","key":"X3JLZPQHky"},{"type":"text","value":" available at ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uf9gYi5tLd"},{"type":"link","url":"https://github.com/MeteoSwiss/fast-barnes-py.git","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"fast-barnes-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dP4FZo0NXG"}],"urlSource":"https://github.com/MeteoSwiss/fast-barnes-py.git","error":true,"key":"zuQKjLkGEF"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IA1PiJGCLL"}],"key":"JQR48mM5b5"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The notebook applies the fast Barnes interpolation methods to RHI scan data from the ","key":"rQmbuRwJXL"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"X5t7q99axI"}],"key":"DoftP8bkWP"},{"type":"text","value":"-CSAPR2 radar data from the [TRACER] (","key":"COucy6sqCc"},{"type":"link","url":"https://www.arm.gov/research/campaigns/amf2021tracer","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​www​.arm​.gov​/research​/campaigns​/amf2021tracer","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U3XpTBEnRO"}],"urlSource":"https://www.arm.gov/research/campaigns/amf2021tracer","key":"Zs2Bim5CMF"},{"type":"text","value":") field campaign.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JQ3iF0adCA"}],"key":"hHJJIJX5As"}],"key":"yrQcUt4VQn"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T0oDnQL3xM"}],"key":"ydzKhDIN1u"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KZEqDgg8QC"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"BwBaMMxIKN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook shows how to download the ","key":"lCT0MONlAg"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"nIVwipsPs7"}],"key":"RpwmPXRMt6"},{"type":"text","value":"-CSAPR2 RHI data from ","key":"vt3W28H4Y1"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"BsmuGGPU0x"}],"key":"rQPxQs8deS"},{"type":"text","value":" data repository and grid radar variables on a two-dimensional Cartesian grid using Python.","key":"KMR3fY141i"}],"key":"ZzjTqgyuWs"}],"key":"XUuAzsWDQF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KvUvvWbcAF"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"SmZNON2Wuw"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rPdfJ7x94E"}],"key":"VFhsZd089E"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KEsBHWiiYT"}],"key":"gcjKIK1L2x"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xrQjovbTqt"}],"key":"FtOX9esgW8"}],"key":"Ias9m2sTMP"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/xarray/xarray-intro.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Intro to Xarray","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JhFDJuXjBD"}],"urlSource":"https://foundations.projectpythia.org/core/xarray/xarray-intro.html","key":"CvIZt3v8IQ"}],"key":"keSt0ocXOn"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gLIdaKocBb"}],"key":"PrNUKkrcDy"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"SHmtbdNGKu"}],"key":"GIG8DoH3l9"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Matplotlib Basics","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"A0Zvt8t7Je"}],"urlSource":"https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics.html","key":"UyRgbwvOOm"}],"key":"t6ahKtPtFh"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Required","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"deTSRQYHOd"}],"key":"p3IOIasEsX"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Basic plotting","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Sx65td6sAk"}],"key":"rlOR1K9IVs"}],"key":"hIHfk9NoLV"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"/pyart-basics","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Py-ART Basics","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jxD8iUT6O1"}],"urlSource":"../foundations/pyart-basics","dataUrl":"/pyart-basics.json","internal":true,"protocol":"file","key":"sJyquYBFrE"}],"key":"pAdp5ur28m"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Required","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UoMtxOU2xl"}],"key":"OeA3RYZYAY"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"IO/Visualization","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"S6PcvaR1Lx"}],"key":"UhwevDGCht"}],"key":"IZ0GDRzTjJ"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/data-formats/netcdf-cf.html","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Understanding of NetCDF","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"GwbhXINEaf"}],"urlSource":"https://foundations.projectpythia.org/core/data-formats/netcdf-cf.html","key":"VRRMEuSGDT"}],"key":"yBizdiDR24"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qjKvhePuuE"}],"key":"yfAU3nGlvP"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Familiarity with metadata structure","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ecU45CXs9e"}],"key":"tyUf5VwcVa"}],"key":"aruLGHJ5J9"}],"key":"Ow9bOQqTXD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"q2sjApgChd"}],"key":"dyBISZpNGg"},{"type":"text","value":": 10 minutes","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gOMp5rfPO7"}],"key":"DdGXCGOb94"}],"key":"tecEtxIjvL"}],"key":"kOqySqOtcZ"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b2ZGBD6WE2"}],"key":"ki5egg491C"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d01lfqPKmB"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"xc3VcylE3j"}],"key":"LTD4kjApfY"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import pyart\nimport act\nimport glob\nimport os\nimport numpy as np\nimport xarray as xr\nimport matplotlib.pyplot as plt\nfrom pathlib import Path\nfrom copy import deepcopy\nfrom fastbarnes.interpolation import barnes\nfrom datetime import timedelta","visibility":"show","key":"hJKSDJMDxQ"},{"type":"output","id":"Jh0Pzn4qPwQhh_TsuWAk4","data":[{"output_type":"stream","name":"stdout","text":"\n## You are using the Python ARM Radar Toolkit (Py-ART), an open source\n## library for working with weather radar data. Py-ART is partly\n## supported by the U.S. Department of Energy as part of the Atmospheric\n## Radiation Measurement (ARM) Climate Research Facility, an Office of\n## Science user facility.\n##\n## If you use this software to prepare a publication, please cite:\n##\n##     JJ Helmus and SM Collis, JORS 2016, doi: 10.5334/jors.119\n\n"}],"visibility":"show","key":"mW8mWI4ZgZ"}],"visibility":"show","key":"t38gbf58mj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setup our Download Query","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ieq8oeQjyj"}],"identifier":"setup-our-download-query","label":"Setup our Download Query","html_id":"setup-our-download-query","implicit":true,"key":"JhV5ehnzbW"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Before downloading our data, we need to make sure we have an ","key":"D8D1dg4thg"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"ikyvurAdzw"}],"key":"JxQkI8xnFq"},{"type":"text","value":" Data Account, and ","key":"jPOLLShmOd"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"PXTzIfIH1P"}],"key":"YNVPmFISsy"},{"type":"text","value":" Live token. Both of these can be found using this link:","key":"wHkk0wwGsB"}],"key":"VnNaXOMOOe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://adc.arm.gov/armlive/livedata/home","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ARM Live Signup","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H1wq7Ky5N3"}],"urlSource":"https://adc.arm.gov/armlive/livedata/home","key":"dRfBOgNcxU"}],"key":"FjXdgmaCYN"}],"key":"YmJOsm1HWx"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Once you sign up, you will see your token. Copy and replace that where we have ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pxC7MyYzkz"},{"type":"inlineCode","value":"arm_username","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"j8RjSeWHzp"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"b4SqdntBK6"},{"type":"inlineCode","value":"arm_password","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rD8GR6FBMe"},{"type":"text","value":" below.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fi3W40fZtX"}],"key":"pUX1n1qqjG"}],"key":"OI25Z9haub"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"arm_username = os.getenv(\"ARM_USERNAME\")\narm_password = os.getenv(\"ARM_PASSWORD\")\n\ndatastream = \"houcsapr2cfrS2.a1\"\n\nstart_date = \"2022-08-07T18:39:04\"\nend_date = \"2022-08-07T18:39:05\"","visibility":"show","key":"Itqi96JjYv"},{"type":"output","id":"1G4aJtTly4ejWRBfOPfu0","data":[],"visibility":"show","key":"PNzQTflSJq"}],"visibility":"show","key":"mufQIquFPs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Grab Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SEdDLefWd6"}],"identifier":"grab-data","label":"Grab Data","html_id":"grab-data","implicit":true,"key":"sdYTyQ2Uip"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We use the ","key":"CNdOSd2XuF"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"kvE26Ud2Lt"}],"key":"rq0ouFvne8"},{"type":"text","value":" Live API, accessible through ACT!","key":"q35YfcEclL"}],"key":"e6LB4LYgpI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://arm-doe.github.io/ACT/API/generated/act.discovery.download_arm_data.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Download Data API","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hZkclf0Avj"}],"urlSource":"https://arm-doe.github.io/ACT/API/generated/act.discovery.download_arm_data.html","key":"yKapyLcEcH"}],"key":"tpibiWpAUY"}],"key":"uUTItX5lNt"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We are interested in the C-band radar, which is utilizing a cell-tracking algorithm, with the datastream","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"J6YnP2nxnT"}],"key":"klZ4n5w9E0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"houcsapr2cfrS2.a1","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"fVdbCIUjn4"}],"key":"wcMvCE7K7U"}],"key":"HVtNGSoQtQ"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"One of the better cases was from June 2, 2022.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"laNjvX9REr"}],"key":"fS45c7mGW5"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This line will download data into the a new directory with the datastream name (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"CNyVygQbmC"},{"type":"inlineCode","value":"/houcsapr2cfrS2.a1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"xGPepFFIlD"},{"type":"text","value":")","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Pn2M5uvOj4"}],"key":"yjhrTheVIq"}],"key":"pNBsodc057"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"aug7_csapr_files = act.discovery.download_arm_data(arm_username,\n                                               arm_password,\n                                               datastream,\n                                               start_date,\n                                               end_date)","visibility":"show","key":"QRJ17EkSBA"},{"type":"output","id":"9pGvLo9-sZn3yF6m9DN79","data":[{"output_type":"stream","name":"stdout","text":"[DOWNLOADING] houcsapr2cfrS2.a1.20220807.183904.nc\n"},{"output_type":"stream","name":"stdout","text":"\nIf you use these data to prepare a publication, please cite:\n\nBharadwaj, N., Collis, S., Hardin, J., Isom, B., Lindenmaier, I., Matthews, A.,\nNelson, D., Feng, Y.-C., Rocque, M., Wendler, T., & Castro, V. C-Band Scanning\nARM Precipitation Radar (CSAPR2CFR), 2022-08-07 to 2022-08-07, ARM Mobile\nFacility (HOU), Houston, TX; Supplemental Facility 2 (S2). Atmospheric Radiation\nMeasurement (ARM) User Facility. https://doi.org/10.5439/1467901\n\n"}],"visibility":"show","key":"CV4nstD30I"}],"visibility":"show","key":"D1juu0QIPJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read in and Plot the Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NmtBy6IKJ0"}],"identifier":"read-in-and-plot-the-data","label":"Read in and Plot the Data","html_id":"read-in-and-plot-the-data","implicit":true,"key":"aq8Lxxi7C6"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Before following running the next cells, make sure you have created the following directories:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uvTcE0pBix"}],"key":"YB33w2xtiA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"quicklooks","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RiDvrrh96Z"}],"key":"bKjntJBfOL"}],"key":"tVEdiO1zX6"}],"key":"gGpuMVYF0K"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"!mkdir quicklooks","visibility":"show","key":"GoTJOogEPn"},{"type":"output","id":"sRsLUK0GVh81r2sS9jTdE","data":[],"visibility":"show","key":"CbUZTnrfQR"}],"visibility":"show","key":"hA4NDQHl2b"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"radar_file = \"houcsapr2cfrS2.a1/houcsapr2cfrS2.a1.20220807.183904.nc\"","visibility":"show","key":"bb1LQuChVD"},{"type":"output","id":"uSiS3LFPcpTntaEH6chy9","data":[],"visibility":"show","key":"i0KBUKEoJ5"}],"visibility":"show","key":"OP41dxdpnF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot one of the RHI scans","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Qv0pn1Qv2G"}],"identifier":"plot-one-of-the-rhi-scans","label":"Plot one of the RHI scans","html_id":"plot-one-of-the-rhi-scans","implicit":true,"key":"Q1aZWBCZtk"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We read in the data corresponding to 7 August 2022 18:39:04 UTC, and plot a basic ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vEri1DJY2O"},{"type":"inlineCode","value":"RadarDisplay","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EI4XJqE7qo"},{"type":"text","value":" which will automatically detect whether the plot is a vertical cross section (RHI or VPT), or a horizontal scan (PPI)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"f7oVnXSEHj"}],"key":"sJXf1nT0EL"}],"key":"Z1mctVcE6Y"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"radar = pyart.io.read(radar_file)\ndisplay = pyart.graph.RadarDisplay(radar)\ndisplay.plot(\"reflectivity\", 0)\nplt.savefig(f\"quicklooks/{Path(radar_file).stem}.png\", dpi=200)\nplt.xlim(0,45)\nplt.ylim(0,12)\nplt.show()\nplt.close() ","visibility":"show","key":"awePDzeMqS"},{"type":"output","id":"vM98GGP0-YWV6PmzJDwCi","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"25fc432a1b4e4906640403dd8bcc99d8","path":"/radar-cookbook/build/25fc432a1b4e4906640403dd8bcc99d8.png"}}}],"visibility":"show","key":"RLyn0WihTe"}],"visibility":"show","key":"mF4BexErmg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define a function to grid the RHI data from polar (antenna) coordinates to a two-dimensional Caretsian grid","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GvyuedElgZ"}],"identifier":"define-a-function-to-grid-the-rhi-data-from-polar-antenna-coordinates-to-a-two-dimensional-caretsian-grid","label":"Define a function to grid the RHI data from polar (antenna) coordinates to a two-dimensional Caretsian grid","html_id":"define-a-function-to-grid-the-rhi-data-from-polar-antenna-coordinates-to-a-two-dimensional-caretsian-grid","implicit":true,"key":"vy82ugsbuZ"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We use numba to vectorize the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"z7DD4rf81i"},{"type":"inlineCode","value":"dist_func","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WAEYPtzEmb"},{"type":"text","value":" function to calculate the distance of each range gate from the radar. This makes our code run faster than simply executing this function for each gate in a for loop.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BKb6VOUDpV"}],"key":"bABlUg4WEo"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Next, we use the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Fvqadw69Lr"},{"type":"inlineCode","value":"barnes","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wqxdy2O4cL"},{"type":"text","value":" function from the fastbarnes Python package to interpolate the radar fields such as ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LqTJRnitXh"},{"type":"inlineCode","value":"equivalent reflectivity factor","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UQnGhFK1zA"},{"type":"text","value":" (","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"h3hZxXoFUT"},{"type":"inlineMath","value":"Z_{H}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi>H</mi></msub></mrow><annotation encoding=\"application/x-tex\">Z_{H}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ElFyrBizWE"},{"type":"text","value":"), ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fd5uImogM7"},{"type":"inlineCode","value":"differential_reflectivity","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PmK2UJSJUH"},{"type":"text","value":" (","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XsdIveJBBw"},{"type":"inlineMath","value":"Z_{DR}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>D</mi><mi>R</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Z_{DR}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"oceHitdXFb"},{"type":"text","value":"), and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jqPjD3Guov"},{"type":"inlineCode","value":"specific_differential_phase","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GIdhqgFG4h"},{"type":"text","value":" (","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"G52AK4vfO5"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"y3qApBceD6"},{"type":"text","value":") to a uniform range-height Cartesian grid.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"t9aBueBWhR"}],"key":"vc8ZqfgvYF"}],"key":"cFk9dHM9bx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def grid_rhi(file,z_res = 100,rng_res = 100,z_limits = (0,15000),rng_limits = (0,109900.0),fields=None):\n    \n    \"\"\"\n    Input:\n    -------\n    file (str): Path of the RHI scan file that needs to be gridded.\n    z_res (float): Vertical grid spacing of the Cartesian grid.\n    rng_res (float): Horizontal grid spacing of the Cartesian grid.\n    z_limits (tuple): Lower and upper height limits within which radar data needs to be gridded. \n    rng_limits (tuple): Lower and upper range limits within which radar data needs to be gridded. \n    \n    Output:\n    -------\n    grid_ds (xarray Dataset): Xarray dataset containing radar fields on the Cartesian grid\n    \"\"\"\n    \n    z_pts = np.arange(z_limits[0],z_limits[1]+z_res,z_res)\n    rng_pts = np.arange(rng_limits[0],rng_limits[1]+rng_res,rng_res)\n   \n    \n    rhi = xr.open_dataset(file)\n    radar = pyart.io.read(file)\n    rhi = rhi.swap_dims({'time':'elevation'})\n\n    lat = float(radar.latitude[\"data\"])\n    lon = float(radar.longitude[\"data\"])\n\n    grid_origin = (lat, lon)\n    grid_origin_lat, grid_origin_lon = grid_origin\n\n    grid_projection = {\"proj\": \"aeqd\", \"_include_lon_0_lat_0\": True}\n    projparams = grid_projection.copy()\n\n    if projparams.pop(\"_include_lon_0_lat_0\", False):\n        projparams[\"lon_0\"] = grid_origin_lon\n        projparams[\"lat_0\"] = grid_origin_lat\n\n    rg_loc = np.tile(radar.range['data'],len(radar.elevation['data'])).reshape(len(radar.elevation['data']),len(radar.range['data']))\n\n    zg_loc = radar.gate_altitude[\"data\"] - 12 # CSAPR2 antenna altitude = 12 m in this example\n\n     \n    # one of [ 'naive', 'radius', 'convolution', 'optimized_convolution' ]\n    method = \"optimized_convolution\"\n\n    # one of [ 0.25, 0.5, 1.0, 2.0, 4.0 ]\n    sigma = 1.0\n\n    # applies only to 'convolution' interpolations: one of [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 50 ]\n    num_iter = 4\n    \n    if fields is None:\n        fields = ['reflectivity','differential_reflectivity','specific_differential_phase',\n                  'copol_correlation_coeff','mean_doppler_velocity','spectral_width']\n        \n    res_field = np.empty((len(z_pts),len(rng_pts),len(fields)))\n\n    for j in range(len(fields)):\n\n        data = deepcopy(np.array(radar.fields[fields[j]]['data']))\n        # data = data.filled(np.nan)\n\n        res_field[:,:,j] = barnes(np.asarray([rg_loc.ravel(),radar.gate_altitude['data'].ravel()]),\n                           data.ravel(),\n                           100,\n                           np.asarray([0,0]),\n                           100,\n                           (len(z_pts),len(rng_pts)),\n                           method=method,\n                           num_iter = num_iter,\n                           min_weight=0.0002\n                          )\n    \n\n    data_dict = {}\n    for k in range(len(fields)):\n        data_dict[fields[k]] = ([\"z\",\"range\"],res_field[:,:,k])\n\n    grid_ds = xr.Dataset(data_vars=data_dict,\n                         coords=dict(z=([\"z\"], z_pts),\n                                     range=([\"range\"],rng_pts),\n                                    ),\n                         attrs=dict(description=\"Gridded RHI data.\"),\n                        )\n        \n    return grid_ds","visibility":"show","key":"SdpIUDNcAj"},{"type":"output","id":"p85XDgaq0KFYrasCweV8s","data":[],"visibility":"show","key":"xCBcONBGa3"}],"visibility":"show","key":"sSUDNXRKxD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Apply the gridding function to your radar RHI data file","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KMOpDIFgSo"}],"identifier":"apply-the-gridding-function-to-your-radar-rhi-data-file","label":"Apply the gridding function to your radar RHI data file","html_id":"apply-the-gridding-function-to-your-radar-rhi-data-file","implicit":true,"key":"Ar35ceUaX1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now, we are ready to grid the RHI data. The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BXXe8iMxU3"},{"type":"inlineCode","value":"grid_rhi","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gsq0boDFO6"},{"type":"text","value":" function requires the user to specify the vertical and horizontal grid spacing (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IpqhhubKC7"},{"type":"inlineCode","value":"z_res","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wxDNjIXztK"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pV0vJFw5av"},{"type":"inlineCode","value":"rng_res","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BxJ62z4BGF"},{"type":"text","value":", respectively), as well as the lower and upper limits of the Cartesian grid in the vertical and horizontal dimensions (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Py4nn7jscj"},{"type":"inlineCode","value":"z_limits","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cqQL3u37rA"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"P65fIo5Ppi"},{"type":"inlineCode","value":"rng_limits","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BYbGGZwNL8"},{"type":"text","value":", respectively). Custom fields of interest can be specified through the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QrU429wHX4"},{"type":"inlineCode","value":"fields","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vHHW18qObx"},{"type":"text","value":" parameter. Otherwise, the function grids five radar fields by default i.e., (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"P1IdpJxmgK"},{"type":"inlineMath","value":"Z_{H}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi>H</mi></msub></mrow><annotation encoding=\"application/x-tex\">Z_{H}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"etw7E7U90g"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y6NIFGZ518"},{"type":"inlineMath","value":"Z_{DR}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>D</mi><mi>R</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Z_{DR}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hePLkVbGK9"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NdUsFFU3AV"},{"type":"inlineMath","value":"\\rho_{hv}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>h</mi><mi>v</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\rho_{hv}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"E1ycfIQAg6"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rE8kgQIhwA"},{"type":"inlineMath","value":"K_{DP}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mrow><mi>D</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">K_{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MfXLmKzWJG"},{"type":"text","value":", and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iwwuHDyfpm"},{"type":"text","value":"σ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OxNiJRUScs"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ECkWZAm4oL"}],"key":"BUuYIJX7V5"}],"key":"RJZWiShLhA"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"grid_ds = grid_rhi(radar_file)","visibility":"show","key":"xC6UPfopEK"},{"type":"output","id":"oR5KxydAhwOWqYOp5OKDd","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mRuntimeError\u001b[39m                              Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[8]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m grid_ds = \u001b[43mgrid_rhi\u001b[49m\u001b[43m(\u001b[49m\u001b[43mradar_file\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[7]\u001b[39m\u001b[32m, line 63\u001b[39m, in \u001b[36mgrid_rhi\u001b[39m\u001b[34m(file, z_res, rng_res, z_limits, rng_limits, fields)\u001b[39m\n\u001b[32m     60\u001b[39m     data = deepcopy(np.array(radar.fields[fields[j]][\u001b[33m'\u001b[39m\u001b[33mdata\u001b[39m\u001b[33m'\u001b[39m]))\n\u001b[32m     61\u001b[39m     \u001b[38;5;66;03m# data = data.filled(np.nan)\u001b[39;00m\n\u001b[32m---> \u001b[39m\u001b[32m63\u001b[39m     res_field[:,:,j] = \u001b[43mbarnes\u001b[49m\u001b[43m(\u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43masarray\u001b[49m\u001b[43m(\u001b[49m\u001b[43m[\u001b[49m\u001b[43mrg_loc\u001b[49m\u001b[43m.\u001b[49m\u001b[43mravel\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43mradar\u001b[49m\u001b[43m.\u001b[49m\u001b[43mgate_altitude\u001b[49m\u001b[43m[\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mdata\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mravel\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m     64\u001b[39m \u001b[43m                       \u001b[49m\u001b[43mdata\u001b[49m\u001b[43m.\u001b[49m\u001b[43mravel\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m     65\u001b[39m \u001b[43m                       \u001b[49m\u001b[32;43m100\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[32m     66\u001b[39m \u001b[43m                       \u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43masarray\u001b[49m\u001b[43m(\u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m0\u001b[39;49m\u001b[43m,\u001b[49m\u001b[32;43m0\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m     67\u001b[39m \u001b[43m                       \u001b[49m\u001b[32;43m100\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[32m     68\u001b[39m \u001b[43m                       \u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mlen\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mz_pts\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[38;5;28;43mlen\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mrng_pts\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m     69\u001b[39m \u001b[43m                       \u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m=\u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m     70\u001b[39m \u001b[43m                       \u001b[49m\u001b[43mnum_iter\u001b[49m\u001b[43m \u001b[49m\u001b[43m=\u001b[49m\u001b[43m \u001b[49m\u001b[43mnum_iter\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m     71\u001b[39m \u001b[43m                       \u001b[49m\u001b[43mmin_weight\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m0.0002\u001b[39;49m\n\u001b[32m     72\u001b[39m \u001b[43m                      \u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     75\u001b[39m data_dict = {}\n\u001b[32m     76\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m k \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;28mlen\u001b[39m(fields)):\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/radar-cookbook-dev/lib/python3.11/site-packages/fastbarnes/interpolation.py:115\u001b[39m, in \u001b[36mbarnes\u001b[39m\u001b[34m(pts, val, sigma, x0, step, size, method, num_iter, max_dist, min_weight)\u001b[39m\n\u001b[32m    113\u001b[39m dim = pts.shape[\u001b[32m1\u001b[39m]\n\u001b[32m    114\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m dim < \u001b[32m1\u001b[39m \u001b[38;5;129;01mor\u001b[39;00m dim > \u001b[32m3\u001b[39m:\n\u001b[32m--> \u001b[39m\u001b[32m115\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mRuntimeError\u001b[39;00m(\u001b[33m'\u001b[39m\u001b[33mBarnes interpolation supports only sample points in dimensions 1, 2 or 3\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m    117\u001b[39m \u001b[38;5;66;03m# check structure of sample values array val\u001b[39;00m\n\u001b[32m    118\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(val, np.ndarray):\n\n\u001b[31mRuntimeError\u001b[39m: Barnes interpolation supports only sample points in dimensions 1, 2 or 3","ename":"RuntimeError","evalue":"Barnes interpolation supports only sample points in dimensions 1, 2 or 3"}],"visibility":"show","key":"ffX6iUpa1W"}],"visibility":"show","key":"h5OUpJtlmA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Grid and plot the RHI data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q1b6tgeVQ7"}],"identifier":"grid-and-plot-the-rhi-data","label":"Grid and plot the RHI data","html_id":"grid-and-plot-the-rhi-data","implicit":true,"key":"fwAhReAG7l"}],"key":"WxhmdDlCbI"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Finally, plot the gridded reflectivity\nfig,ax = plt.subplots()\ngrid_ds['reflectivity'].plot(vmin=0,vmax=70,cmap='HomeyerRainbow',ax=ax)\nax.set_xlim(0,55000)\nax.set_ylim(0,10000)\nplt.show()","visibility":"show","key":"C73qoEliqi"},{"type":"output","id":"7IxCUrN9VznrBzxTYgjDO","data":[],"visibility":"show","key":"w9c21Nl89E"}],"visibility":"show","key":"k6ZEBX2fOx"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qRbJlTb4hm"}],"key":"Lx62PKk8HJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UUdcnDdexg"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"zOJpIw0sdN"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Within this example, we walked through how to access ","key":"sCqVoHx83D"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"rnCdZ44IQX"}],"key":"WE1Eh9jo1s"},{"type":"text","value":" data from a field campaign in Texas, plot a quick look of the RHI scan data, and grid our RHI data from native (polar) coordinates to a uniform range-height Caretsian grid.","key":"OJRoOMQvdG"}],"key":"yDF6PTYVtq"}],"key":"ia0ZU2BKs0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and References","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ubxelfDO8B"}],"identifier":"resources-and-references","label":"Resources and References","html_id":"resources-and-references","implicit":true,"key":"DqZp9hhAiJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"link","url":"https://adc.arm.gov/discovery","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"ARM Data Discovery","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lLvJAMbduY"}],"urlSource":"https://adc.arm.gov/discovery","key":"cqW9k215sm"}],"key":"vr2SiL4Src"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://www.arm.gov/research/campaigns/amf2021tracer","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"TRACER Field Campaign","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vx9i0b0NmM"}],"urlSource":"https://www.arm.gov/research/campaigns/amf2021tracer","key":"eDUn8EK5DK"}],"key":"sVebINIwLj"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"CSAPR Radar Data:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mxELWOLwmd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Bharadwaj, N., Collis, S., Hardin, J., Isom, B., Lindenmaier, I., Matthews, A., & Nelson, D. C-Band Scanning ","key":"A5Er0Uf3bL"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"yLdeD63DOQ"}],"key":"fCs4iMOU6S"},{"type":"text","value":" Precipitation Radar (CSAPR2CFR). Atmospheric Radiation Measurement (","key":"ZSIEVGOiuf"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"H4rZT9ElQV"}],"key":"dHzarRmoyL"},{"type":"text","value":") User Facility. ","key":"N9BE1SzwT8"},{"type":"cite","url":"https://doi.org/10.5439/1467901","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Bharadwaj ","key":"jBMsMqM66q"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"lFstyvEPjT"}],"key":"S1HGlAishN"},{"type":"text","value":" (2021)","key":"m4toDPAyIv"}],"kind":"narrative","label":"https://doi.org/10.5439/1467901","identifier":"https://doi.org/10.5439/1467901","enumerator":"2","key":"iSO992q2OP"}],"key":"kFwF69x66y"}],"key":"s2JTUF3JDK"}],"key":"YSX0aS83zg"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Py-ART:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"N6iMLbVIXs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helmus, J.J. & Collis, S.M., (2016). The Python ","key":"ubZvhynuZO"},{"type":"abbreviation","title":"Atmospheric Radiation Measurement","children":[{"type":"text","value":"ARM","key":"xCNVGZW6sU"}],"key":"zCRx7hFD23"},{"type":"text","value":" Radar Toolkit (Py-ART), a Library for Working with Weather Radar Data in the Python Programming Language. Journal of Open Research Software. 4(1), p.e25. DOI: ","key":"DhK7ipJeFH"},{"type":"cite","url":"http://doi.org/10.5334/jors.119","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helmus & Collis (2016)","key":"AYB7aLMmwJ"}],"kind":"narrative","label":"Helmus_2016","identifier":"http://doi.org/10.5334/jors.119","enumerator":"3","key":"KjmTjUpleg"}],"key":"gJOoFpa1hp"}],"key":"GbezgK5a9F"}],"key":"LXg8Fs2Mhi"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"ACT:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tDPA865WmP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Adam Theisen, Ken Kehoe, Zach Sherman, Bobby Jackson, Alyssa Sockol, Corey Godine, Max Grover, Jason Hemedinger, Jenni Kyrouac, Maxwell Levin, Michael Giansiracusa (2022). The Atmospheric Data Community Toolkit (ACT). Zenodo. DOI: ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DORSW245Oz"},{"type":"cite","url":"https://doi.org/10.5281/zenodo.6712343","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Theisen ","key":"l0tCrkgkIK"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"flxX8GMFdP"}],"key":"A2fCLa94hM"},{"type":"text","value":" (2022)","key":"NGHZPm2ZMf"}],"kind":"narrative","label":"https://doi.org/10.5281/zenodo.6712343","identifier":"https://doi.org/10.5281/zenodo.6712343","enumerator":"4","key":"KuyaNT1Qnj"}],"key":"D8qevQGM5c"}],"key":"E81gXbWYdT"}],"key":"VF2ti198pO"}],"key":"lzbmKgFC9g"}],"key":"rgPkcWrhmJ"}],"key":"ge1MfK20Xn"},"references":{"cite":{"order":["Z_rcher_2023","https://doi.org/10.5439/1467901","Helmus_2016","https://doi.org/10.5281/zenodo.6712343"],"data":{"Z_rcher_2023":{"label":"Z_rcher_2023","enumerator":"1","doi":"10.5194/gmd-16-1697-2023","html":"Zürcher, B. K. (2023). Fast approximate Barnes interpolation: illustrated by Python-Numba implementation fast-barnes-py v1.0. <i>Geoscientific Model Development</i>, <i>16</i>(6), 1697–1711. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5194/gmd-16-1697-2023\">10.5194/gmd-16-1697-2023</a>","url":"https://doi.org/10.5194/gmd-16-1697-2023"},"https://doi.org/10.5439/1467901":{"label":"https://doi.org/10.5439/1467901","enumerator":"2","doi":"10.5439/1467901","html":"Bharadwaj, N., Collis, S., Hardin, J., Isom, B., Lindenmaier, I., Matthews, A., Nelson, D., Feng, Y.-C., Rocque, M., Wendler, T., & Castro, V. (2021). <i>C-Band Scanning ARM Precipitation Radar, 2nd Generation</i>. Atmospheric Radiation Measurement (ARM) Archive, Oak Ridge National Laboratory (ORNL), Oak Ridge, TN (US); ARM Data Center, Oak Ridge National Laboratory (ORNL), Oak Ridge, TN (United States). <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5439/1467901\">10.5439/1467901</a>","url":"https://doi.org/10.5439/1467901"},"Helmus_2016":{"label":"Helmus_2016","enumerator":"3","doi":"10.5334/jors.119","html":"Helmus, J. J., & Collis, S. M. (2016). The Python ARM Radar Toolkit (Py-ART), a Library for Working with Weather Radar Data in the Python Programming Language. <i>Journal of Open Research Software</i>, <i>4</i>(1), 25. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5334/jors.119\">10.5334/jors.119</a>","url":"https://doi.org/10.5334/jors.119"},"https://doi.org/10.5281/zenodo.6712343":{"label":"https://doi.org/10.5281/zenodo.6712343","enumerator":"4","doi":"10.5281/ZENODO.6712343","html":"Theisen, A., Kehoe, K., Sherman, Z., Jackson, B., Sockol, A., Godine, C., Grover, M., Hemedinger, J., Kyrouac, J., Levin, M., & Giansiracusa, M. (2022). <i>ARM-DOE/ACT: ACT Release v1.1.9</i>. Zenodo. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5281/ZENODO.6712343\">10.5281/ZENODO.6712343</a>","url":"https://doi.org/10.5281/ZENODO.6712343"}}}},"footer":{"navigation":{"prev":{"title":"Data Quality Check from the CACTI Field Campaign","url":"/cacti-data-quality-example","group":"Example Workflows"},"next":{"title":"Echo top height calculation from NEXRAD PPI volume data:","url":"/echo-top-height","group":"Example Workflows"}}},"domain":"http://localhost:3000"}